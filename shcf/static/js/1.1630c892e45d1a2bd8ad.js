webpackJsonp([1],{"hYk/":function(e,r,l){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=l("gBtx"),t=l.n(o),a=l("y/rj"),n=l("JUEn"),i=l("//Fk"),s=l.n(i);function c(e){return new s.a(function(e,r){if("undefined"!=typeof BMap)return e(BMap),!0;window.onBMapCallback=function(){console.log("百度地图脚本初始化成功..."),e(BMap)};var l=document.createElement("script");l.setAttribute("type","text/javascript"),l.setAttribute("src","https://api.map.baidu.com/api?v=2.0&ak=Zgvao4zZE6L1DYqiGocXjkSSULStabdQ&s=1&callback=onBMapCallback"),document.body.appendChild(l)})}var m={components:{},data:function(){return{dialogImageUrl:"",dialogVisible:!1,imagelist:[],action:"http://101.231.89.126:8300/v1/upload",picUrl:"http://101.231.89.126:8300",time:["08:00:00","18:00:00"],flagUpdate:!1,id:"",flag:0,dialogMapperVisible:!1,provinceTree:[],cityTree:[],countyTree:[],ruleForm:{id:"",clientId:"",companyTime:"",companyDesc:"",companyType:"",companyName:"",master:"",phone:"",tel:"",address:"",province:"",city:"",county:"",lng:"",lat:"",companyLogo:"",paths:""},rules:{companyName:{required:!0,message:"门店名称不允许为空",trigger:"blur"},companyLogo:{required:!0,message:"门店图标不允许为空",trigger:"blur"},companyDesc:{required:!0,message:"门店介绍不允许为空",trigger:"blur"},companyType:{required:!0,message:"请选择门店类型",trigger:"blur"}}}},mounted:function(){this.$nextTick(function(){this.id=this.$route.query.id,this.ruleForm.clientId=this.$route.query.clientId,this.id?this.load():this.initMap(),this.flag=t()(this.$route.query.flag),this.getAreaData(1,"")})},computed:{uploadDisabled:function(){return this.imagelist.length>9}},methods:{submitForm:function(e){var r=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;1===r.flag?Object(n.c)(r.ruleForm).then(function(e){console.log("ok"),r.$router.go(-1)}):2===r.flag?Object(n.e)(r.ruleForm).then(function(e){console.log("ok"),r.$router.go(-1)}):console.log("error submit!!:"+r.flag)})},resetForm:function(e){this.$refs[e].resetFields()},load:function(){var e=this;Object(n.d)({id:this.id}).then(function(r){e.ruleForm.id=r.new.id,e.ruleForm.clientId=r.new.clientId,e.ruleForm.companyTime=r.new.companyTime,e.ruleForm.companyDesc=r.new.companyDesc,e.ruleForm.companyType=r.new.companyType,e.ruleForm.companyName=r.new.companyName,e.ruleForm.master=r.new.master,e.ruleForm.phone=r.new.phone,e.ruleForm.tel=r.new.tel,e.ruleForm.address=r.new.address,e.ruleForm.province=r.new.province,e.ruleForm.city=r.new.city,e.ruleForm.county=r.new.county,e.ruleForm.lng=r.new.lng,e.ruleForm.lat=r.new.lat,e.ruleForm.companyLogo=r.new.companyLogo,e.imagelist=[],r.new.baseCompanyPicList.length>0&&r.new.baseCompanyPicList.forEach(function(r){e.imagelist.push({url:e.picUrl+r.path}),e.ruleForm.paths+=r.path+","}),e.ruleForm.companyTime&&(e.time=e.ruleForm.companyTime.split("-")),e.initMap()})},getAreaData:function(e,r){var l=this;Object(a.e)({name:r}).then(function(r){1===e?l.provinceTree=r.newList:2===e?l.cityTree=r.newList:(console.log(r.newList),l.countyTree=r.newList)})},onProvinceChange:function(e){console.log(e),this.ruleForm.city="",this.ruleForm.county="",this.getAreaData(2,e)},onCityChange:function(e){console.log(e),this.ruleForm.county="",this.getAreaData(3,e)},handleTimeBlur:function(){this.ruleForm.companyTime=this.time[0]+"-"+this.time[1]},onSuccess:function(e,r,l){console.log("success"),this.ruleForm.paths+=e.url+",",this.imagelist.push(r),1===this.imagelist.length&&(this.ruleForm.companyLogo=e.url)},handleRemove:function(e,r){var l=this;this.imagelist=r,this.ruleForm.paths="",this.imagelist.forEach(function(e){l.ruleForm.paths+=e.url.substring(e.url.indexOf("/images"))+",",l.ruleForm.companyLogo=l.imagelist[0].url.substring(l.imagelist[0].url.indexOf("/images"))})},handlePictureCardPreview:function(e){console.log("preview"),this.dialogImageUrl=e.url,this.dialogVisible=!0},beforeUpload:function(e){console.log("beforeupload")},initMap:function(){var e=this;c().then(function(r){var l=e,o=new r.Map("XSDFXPage",{enableMapClick:!0});if(console.log(e.ruleForm.lng),e.ruleForm.lng){console.log("sssssssss");var t=new r.Point(e.ruleForm.lng,e.ruleForm.lat);o.centerAndZoom(new r.Point(e.ruleForm.lng,e.ruleForm.lat),16);var a=new r.Marker(t);o.addOverlay(a)}else o.centerAndZoom("上海市",16);o.enableScrollWheelZoom(!0),o.disableDoubleClickZoom(),o.addEventListener("click",function(e){for(var t=o.getOverlays(),a=0;a<t.length;a++)o.removeOverlay(t[a]);var n=new r.Point(e.point.lng,e.point.lat),i=new r.Marker(n);o.addOverlay(i),(new r.Geocoder).getLocation(e.point,function(r){var o=r.addressComponents;l.ruleForm.province=o.province,l.ruleForm.city=o.city,l.ruleForm.county=o.district,l.ruleForm.address=o.street+o.streetNumber,l.ruleForm.lng=e.point.lng,l.ruleForm.lat=e.point.lat})})})},chooseMap:function(){var e=this;c().then(function(r){var l=e,o=new r.Map("XSDFXPage",{enableMapClick:!0}),t=e.ruleForm.city+e.ruleForm.county+e.ruleForm.address;(console.log(t),t)&&(console.log("begin"),(new r.Geocoder).getPoint(t,function(e){e?(console.log("begin2"),o.centerAndZoom(e,16),o.addOverlay(new r.Marker(e)),l.ruleForm.lng=e.lng,l.ruleForm.lat=e.lat,console.log(e.lng),console.log(e.lat)):alert("您选择地址没有解析到结果!")},e.ruleForm.city));o.addEventListener("click",function(e){console.log("bbbbbbb");for(var t=o.getOverlays(),a=0;a<t.length;a++)o.removeOverlay(t[a]);var n=new r.Point(e.point.lng,e.point.lat),i=new r.Marker(n);o.addOverlay(i),(new r.Geocoder).getLocation(e.point,function(r){var o=r.addressComponents;l.ruleForm.province=o.province,l.ruleForm.city=o.city,l.ruleForm.county=o.district,l.ruleForm.address=o.street+o.streetNumber,l.ruleForm.lng=e.point.lng,l.ruleForm.lat=e.point.lat})})})},createMarker:function(){console.log("aaaaaaaaa")}}},u={render:function(){var e=this,r=e.$createElement,l=e._self._c||r;return l("div",[l("el-row",{staticClass:"eidtCompany"},[l("el-col",{attrs:{span:23}},[l("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px",size:"mini"}},[l("el-row",[l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"门店名称",prop:"companyName"}},[l("el-input",{model:{value:e.ruleForm.companyName,callback:function(r){e.$set(e.ruleForm,"companyName",r)},expression:"ruleForm.companyName"}})],1)],1)],1),e._v(" "),l("el-row",[l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"门店相册",prop:"companyLogo"}},[l("el-upload",{class:{disabled:e.uploadDisabled},attrs:{action:e.action,limit:10,"before-upload":e.beforeUpload,"on-success":e.onSuccess,"list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,multiple:!1,accept:"image/gif,image/jpeg,image/jpg,image/png,image/svg","file-list":e.imagelist}},[l("i",{staticClass:"el-icon-plus"})]),e._v(" "),l("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(r){e.dialogVisible=r}}},[l("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)],1)],1),e._v(" "),l("el-row",[l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"营业时间",prop:"companyTime"}},[l("el-time-picker",{attrs:{"is-range":"","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",placeholder:"选择时间范围",blur:e.handleTimeBlur(),"value-format":"HH:mm:ss"},model:{value:e.time,callback:function(r){e.time=r},expression:"time"}})],1)],1)],1),e._v(" "),l("el-row",[l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"门店介绍",prop:"companyDesc"}},[l("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.companyDesc,callback:function(r){e.$set(e.ruleForm,"companyDesc",r)},expression:"ruleForm.companyDesc"}})],1)],1)],1),e._v(" "),l("el-row",[l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{prop:"companyType",label:"门店类型"}},[l("el-radio-group",{attrs:{size:"small"},model:{value:e.ruleForm.companyType,callback:function(r){e.$set(e.ruleForm,"companyType",r)},expression:"ruleForm.companyType"}},[l("el-radio-button",{attrs:{label:"1"}},[e._v("维修厂")]),e._v(" "),l("el-radio-button",{attrs:{label:"2"}},[e._v("4S店")]),e._v(" "),l("el-radio-button",{attrs:{label:"3"}},[e._v("洗车店")])],1)],1)],1)],1),e._v(" "),l("el-row",[l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"负责人"}},[l("el-input",{model:{value:e.ruleForm.master,callback:function(r){e.$set(e.ruleForm,"master",r)},expression:"ruleForm.master"}})],1)],1)],1),e._v(" "),l("el-row",[l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"电话"}},[l("el-input",{model:{value:e.ruleForm.phone,callback:function(r){e.$set(e.ruleForm,"phone",r)},expression:"ruleForm.phone"}})],1)],1)],1),e._v(" "),l("el-row",[l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"公司电话"}},[l("el-input",{model:{value:e.ruleForm.tel,callback:function(r){e.$set(e.ruleForm,"tel",r)},expression:"ruleForm.tel"}})],1)],1)],1),e._v(" "),l("el-row",[l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"备注"}},[l("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.remarks,callback:function(r){e.$set(e.ruleForm,"remarks",r)},expression:"ruleForm.remarks"}})],1)],1)],1),e._v(" "),l("el-row",[l("el-col",{attrs:{span:5}},[l("el-form-item",{attrs:{label:"地址省"}},[l("el-select",{attrs:{filterable:"",placeholder:"请选择省"},on:{change:e.onProvinceChange},model:{value:e.ruleForm.province,callback:function(r){e.$set(e.ruleForm,"province",r)},expression:"ruleForm.province"}},e._l(e.provinceTree,function(e,r){return l("el-option",{key:r,attrs:{label:e.name,value:e.name}})}))],1)],1),e._v(" "),l("el-col",{attrs:{span:5}},[l("el-form-item",{attrs:{label:"地址市"}},[l("el-select",{attrs:{filterable:"",placeholder:"请选择市"},on:{change:e.onCityChange},model:{value:e.ruleForm.city,callback:function(r){e.$set(e.ruleForm,"city",r)},expression:"ruleForm.city"}},e._l(e.cityTree,function(e,r){return l("el-option",{key:r,attrs:{label:e.name,value:e.name}})}))],1)],1),e._v(" "),l("el-col",{attrs:{span:5}},[l("el-form-item",{attrs:{label:"地址县"}},[l("el-select",{attrs:{filterable:"",placeholder:"请选择县"},model:{value:e.ruleForm.county,callback:function(r){e.$set(e.ruleForm,"county",r)},expression:"ruleForm.county"}},e._l(e.countyTree,function(e,r){return l("el-option",{key:r,attrs:{label:e.name,value:e.name}})}))],1)],1)],1),e._v(" "),l("el-row",[l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"街道地址"}},[l("el-input",{model:{value:e.ruleForm.address,callback:function(r){e.$set(e.ruleForm,"address",r)},expression:"ruleForm.address"}})],1)],1),e._v(" "),l("el-col",{staticStyle:{"margin-left":"10px"},attrs:{span:3}},[l("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:function(r){e.chooseMap()}}},[e._v("刷新地图")])],1)],1),e._v(" "),l("el-row",[l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"经度"}},[l("el-input",{model:{value:e.ruleForm.lng,callback:function(r){e.$set(e.ruleForm,"lng",r)},expression:"ruleForm.lng"}})],1)],1)],1),e._v(" "),l("el-row",[l("el-col",{attrs:{span:10}},[l("el-form-item",{attrs:{label:"纬度"}},[l("el-input",{model:{value:e.ruleForm.lat,callback:function(r){e.$set(e.ruleForm,"lat",r)},expression:"ruleForm.lat"}})],1)],1)],1),e._v(" "),l("div",{staticStyle:{height:"350px"},attrs:{id:"XSDFXPage"}}),e._v(" "),0!=e.flag?l("el-form-item",[l("el-button",{attrs:{type:"primary"},on:{click:function(r){e.submitForm("ruleForm")}}},[e._v("保存")]),e._v(" "),l("el-button",{on:{click:function(r){e.resetForm("ruleForm")}}},[e._v("重置")])],1):e._e()],1)],1)],1)],1)},staticRenderFns:[]};var p=l("VU/8")(m,u,!1,function(e){l("vZxR")},null,null);r.default=p.exports},vZxR:function(e,r,l){var o=l("y5lM");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);l("rjj0")("6c9fe852",o,!0)},y5lM:function(e,r,l){(e.exports=l("FZ+f")(!1)).push([e.i,"\n.eidtCompany .line {\n  text-align: center;\n}\n.eidtCompany .disabled .el-upload--picture-card {\n  display: none;\n}\n",""])}});