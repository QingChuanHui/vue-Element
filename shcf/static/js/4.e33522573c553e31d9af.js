webpackJsonp([4],{"69uP":function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.car-diaglog .children {\n  margin-bottom: 5px;\n  min-width: 100px;\n  margin-left: 5px;\n}\n.car-diaglog .el-dialog__body {\n  padding-top: 10px !important;\n}\n.car-diaglog .clearfix {\n  height: 25px;\n  line-height: 25px;\n  background-color: #F2F6FC;\n  margin-bottom: 5px;\n  padding-left: 10px;\n}\n.car-diaglog .sidebar {\n  width: 25px;\n  position: absolute;\n  right: 0;\n  top: 0;\n  text-align: center;\n  z-index: 999;\n  font-size: 1em;\n  z-index: 100;\n}\n.car-diaglog .sidebar div {\n    cursor: pointer;\n}\n.car-diaglog .sidebar:hover {\n  background-color: rgba(0, 0, 0, 0.1);\n}\n.car-diaglog .leftBard {\n  width: calc(100% - 25px);\n}\n",""])},L3le:function(e,t,a){var r=a("69uP");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("3c765e2a",r,!0)},VyQ6:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("mvHQ"),i=a.n(r),n=a("gBtx"),l=a.n(n),s=a("qAqO"),o=a("0xDb"),c=a("QXIp"),u={props:{companyId:{type:String,default:""},partList:{type:Array,default:[]}},data:function(){return{dialogTableVisible:!1,page:{},listLoading:!0,listQuery:{partName:"",pageNo:1,pageSize:20}}},methods:{fetchData:function(){var e=this;this.listLoading=!0,Object(c.c)({pageNo:this.listQuery.pageNo,pageSize:this.listQuery.pageSize,partName:this.listQuery.partName,companyId:this.companyId}).then(function(t){e.page=t.page,e.listLoading=!1})},handleSizeChange:function(e){this.listQuery.pageSize=e,this.fetchData()},handleCurrentChange:function(e){this.listQuery.pageNo=e,this.fetchData()},partSelect:function(){this.dialogTableVisible=!0,this.fetchData()},handleTableChange:function(e,t,a){for(var r=!1,i=0;i<this.partList.length;i++)this.partList[i].partId===e.id&&(this.partList[i].amount+=1,r=!0);r||this.partList.push({partId:e.id,partName:e.partName,amount:1,partCode:e.partCode,price:e.price}),this.dialogTableVisible=!1,this.returnData()},handleClose:function(e){for(var t=0;t<this.partList.length;t++)this.partList[t].partId===e&&this.partList.splice(t,1);this.returnData()},returnData:function(){this.$emit("selectSuccess",this.partList)}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"100%"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"small"},on:{click:function(t){e.partSelect()}}},[e._v("商品选择")]),e._v(" "),a("el-card",{directives:[{name:"show",rawName:"v-show",value:e.partList.length>0,expression:"partList.length > 0"}],staticClass:"card"},[a("el-table",{ref:"singleTable",staticClass:"partTable",attrs:{data:e.partList,"highlight-current-row":""}},[a("el-table-column",{attrs:{property:"partCode",label:"商品编码",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"partName",label:"商品名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{property:"price",label:"商品价格",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"数量",align:"center",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input-number",{attrs:{size:"small","controls-position":"right",min:1,max:100},model:{value:t.row.amount,callback:function(a){e.$set(t.row,"amount",a)},expression:"scope.row.amount"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",size:"mini"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-delete del",on:{click:function(a){e.handleClose(t.row.partId)}}})]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"商品选择",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("div",{staticClass:"appCenterTop",staticStyle:{height:"50px"}},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"250px"},attrs:{placeholder:"商品名称",size:"mini",clearable:""},model:{value:e.listQuery.partName,callback:function(t){e.$set(e.listQuery,"partName",t)},expression:"listQuery.partName"}}),e._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:function(t){e.fetchData()}}},[e._v("搜索")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:e.page.records,"element-loading-text":"玩命加载中……",border:"",fit:"","highlight-current-row":"",stripe:"",size:"mini"},on:{"row-click":e.handleTableChange}},[a("el-table-column",{attrs:{label:"商品名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.partName)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"商品编码",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.partCode)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"商品价格",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.price)+"\n        ")]}}])})],1),e._v(" "),a("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{"current-page":e.page.pages,"page-sizes":[20,100,200,300,500,1e3],"page-size":e.page.size,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total,background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var p=a("VU/8")(u,m,!1,function(e){a("yPzP")},"data-v-222861e5",null).exports,d=a("vLgD");var h={data:function(){return{brand:"品牌",cType:"车系",volume:"排量",carYear:"年款",dialogVisible:!1,loading:!1,activeName:"first",carType:"",keyWords:{carBrand:"",pType:"",pVolume:""},brandList:[],carTypeList:[],volumeList:[],carYearList:[],MarkList:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],cssTop:{top:0}}},mounted:function(){document.getElementById("carSelector").addEventListener("scroll",this.scrollDiag);var e=(window.innerHeight-200)/26;e<12&&(e=12),e>24&&(e=24),this.cssTop["line-height"]=e+"px"},methods:{scrollDiag:function(){var e=document.getElementById("carSelector").scrollTop;e>=200?e-=200:e>0&&e<200&&(e=0),this.cssTop.top=e+"px"},jump:function(e){var t=document.querySelectorAll(".brandMark"),a=t[e].offsetTop+100;document.getElementById("carSelector").scrollTop=a},addCarType:function(){this.dialogVisible=!0,this.loadCarBrand()},brandGroup:function(e){return this.brandList.filter(function(t){return t.pCarBrandMark===e})},loadCarBrand:function(){var e,t=this;d.a.fetchPost("/v1/car/getCarTypeBrand",e).then(function(e){t.loading=!1,t.brandList=e.newList})},handleClick:function(e,t){console.log(e,t)},handleSubmit:function(){this.$emit("selectSuccess",this.carType),this.handleClearSelector()},handleBrandClick:function(e){var t,a=this;this.carType="",this.carType+=e+" ",this.keyWords.carBrand=e,this.brand=e,this.cType="车系",this.volume="排量",this.carYear="年款",(t=this.keyWords,d.a.fetchPost("/v1/car/getCarTypes",t)).then(function(e){a.carTypeList=e.newList,a.activeName="second"})},handleCarTypeClick:function(e){var t,a=this;this.carType=this.brand+" "+e+" ",this.keyWords.pType=e,this.cType=e,this.volume="排量",this.carYear="年款",(t=this.keyWords,d.a.fetchPost("/v1/car/getCarVolume",t)).then(function(e){a.volumeList=e.newList,a.activeName="third"})},handleCarVolumeClick:function(e){var t,a=this;this.carType=this.brand+" "+this.cType+" "+e+" ",this.keyWords.pVolume=e,this.volume=e,this.carYear="年款",(t=this.keyWords,d.a.fetchPost("/v1/car/getCarYear",t)).then(function(e){a.carYearList=e.newList,a.activeName="fourth"})},handleCarYearClick:function(e){this.carYear=e,this.carType=this.brand+" "+this.cType+" "+this.volume+" "+e+" "},handleClearSelector:function(){this.dialogVisible=!1,this.carType="",this.brandList=[],this.carTypeList=[],this.volumeList=[],this.carYearList=[],this.activeName="first",this.brand="品牌",this.cType="车系",this.volume="排量",this.carYear="年款"},closeDialog:function(e){this.handleClearSelector()}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"small",plain:""},on:{click:function(t){e.addCarType()}}},[e._v("选择")]),e._v(" "),a("el-dialog",{staticClass:"car-diaglog",attrs:{"append-to-body":"",title:"车型选择",visible:e.dialogVisible,id:"carSelector","before-close":e.closeDialog},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{label:e.brand,name:"first"}},[e._l(e.MarkList,function(t){return a("div",{key:t,staticClass:"leftBard"},[a("div",{staticClass:"clearfix brandMark",attrs:{id:t}},[a("span",[e._v(e._s(t))])]),e._v(" "),e._l(e.brandGroup(t),function(t){return a("el-button",{key:t.id,staticClass:"children",attrs:{plain:"",value:t.pbrandname},on:{click:function(a){e.handleBrandClick(t.pbrandname)}}},[e._v("\n            "+e._s(t.pbrandname)+"\n          ")])})],2)}),e._v(" "),a("div",{staticClass:"sidebar",style:e.cssTop},e._l(e.MarkList,function(t,r){return a("div",{key:r,on:{click:function(t){e.jump(r)}}},[e._v(e._s(t))])}))],2),e._v(" "),a("el-tab-pane",{attrs:{label:e.cType,name:"second"}},e._l(e.carTypeList,function(t){return a("div",{key:t.vender},[a("div",{staticClass:"clearfix"},[a("span",[e._v(e._s(t.vender))])]),e._v(" "),e._l(t.carTypeList,function(t){return a("el-button",{key:t,staticClass:"children",attrs:{plain:""},on:{click:function(a){e.handleCarTypeClick(t)}}},[e._v("\n            "+e._s(t)+"\n          ")])})],2)})),e._v(" "),a("el-tab-pane",{attrs:{label:e.volume,name:"third"}},e._l(e.volumeList,function(t){return a("el-button",{key:t.volume,staticClass:"children",attrs:{plain:""},on:{click:function(a){e.handleCarVolumeClick(t.volume)}}},[e._v("\n        "+e._s(t.volume)+"\n        ")])})),e._v(" "),a("el-tab-pane",{attrs:{label:e.carYear,name:"fourth"}},e._l(e.carYearList,function(t){return a("div",{key:t.year},[a("div",{staticClass:"clearfix"},[a("span",[e._v(e._s(t.year))])]),e._v(" "),e._l(t.list,function(t){return a("el-button",{key:t.psalename,staticClass:"children",attrs:{plain:""},on:{click:function(a){e.handleCarYearClick(t.psalename)}}},[e._v("\n              "+e._s(t.psalename)+"\n          ")])})],2)}))],1),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.handleClearSelector()}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var v=a("VU/8")(h,f,!1,function(e){a("L3le")},null,null).exports,g=a("JAmY"),y={components:{partSelector:p,carSelector:v},data:function(){var e=this;return{companyKindList:[],flagUpdate:!1,id:"",companyId:"",flag:0,ruleForm:{id:"",itemCode:"",itemName:"",companyId:"",baseCompanyItemPartList:[],itemOriginalPrice:0,itemPrice:0,itemDescription:"",itemServiceTime:"",suggestCycle:"",type:"",basePartCarTypeList:[],carTypeState:"0",remarks:""},rules:{itemName:{required:!0,message:"项目名称不允许为空",trigger:"blur"},itemCode:{required:!0,validator:function(t,a,r){""===a&&r(new Error("请输入项目编码")),2===e.flag&&(e.flagUpdate=!0),Object(s.d)({itemCode:a,companyId:e.companyId,flag:e.flagUpdate}).then(function(e){e.new?r(new Error("该项目编码已存在")):r()})},trigger:"blur"},type:{required:!0,message:"请选择业务类别",trigger:"change"}}}},mounted:function(){this.$nextTick(function(){var e=o.c.getSessionStorage("companyId").companyId;this.companyId=this.ruleForm.companyId=e,this.selectCompanyKind(),this.id=this.$route.query.id,this.flag=l()(this.$route.query.flag),this.id&&this.load()})},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.id?Object(s.f)({formData:i()(t.ruleForm)}).then(function(e){t.$message({message:"恭喜你，修改成功",type:"success"}),t.$router.go(-1)}):Object(s.e)({formData:i()(t.ruleForm)}).then(function(e){t.$message({message:"恭喜你，添加成功",type:"success"}),t.$router.go(-1)})})},resetForm:function(e){this.$refs[e].resetFields()},load:function(){var e=this;Object(s.b)({id:this.id}).then(function(t){e.ruleForm.id=t.new.id,e.ruleForm.itemCode=t.new.itemCode,e.ruleForm.itemName=t.new.itemName,e.ruleForm.companyId=t.new.companyId,e.ruleForm.itemOriginalPrice=t.new.itemOriginalPrice,e.ruleForm.itemPrice=t.new.itemPrice,e.ruleForm.itemDescription=t.new.itemDescription,e.ruleForm.itemServiceTime=t.new.itemServiceTime,e.ruleForm.suggestCycle=t.new.suggestCycle,e.ruleForm.type=t.new.type,e.ruleForm.carTypeState=t.new.carTypeState,e.ruleForm.remarks=t.new.remarks,null!=t.new.baseCompanyItemPartList&&(e.ruleForm.baseCompanyItemPartList=t.new.baseCompanyItemPartList),null!=t.new.basePartCarTypeList&&(e.ruleForm.basePartCarTypeList=t.new.basePartCarTypeList)})},partSelect:function(e){this.ruleForm.baseCompanyItemPartList=e},selectCompanyKind:function(){var e=this;Object(g.a)({type:"itemType"}).then(function(t){e.companyKindList=t.newList})},selectChange:function(e){"0"===e&&(this.ruleForm.basePartCarTypeList=[])},carTypeSelect:function(e){this.ruleForm.basePartCarTypeList.push({carTypeName:e})},handleClose:function(e){for(var t=0;t<this.ruleForm.basePartCarTypeList.length;t++)this.ruleForm.basePartCarTypeList[t].carTypeName===e&&this.ruleForm.basePartCarTypeList.splice(t,1)}}},b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",[a("el-col",{attrs:{span:23}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px",size:"mini"}},[a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"项目编码",prop:"itemCode"}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入编码"},model:{value:e.ruleForm.itemCode,callback:function(t){e.$set(e.ruleForm,"itemCode",t)},expression:"ruleForm.itemCode"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"项目名称",prop:"itemName"}},[a("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.ruleForm.itemName,callback:function(t){e.$set(e.ruleForm,"itemName",t)},expression:"ruleForm.itemName"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"业务类别",prop:"type"}},[a("el-select",{staticStyle:{width:"85px"},attrs:{placeholder:"请选择"},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},e._l(e.companyKindList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:15}},[a("el-form-item",{attrs:{label:"对应商品"}},[a("partSelector",{attrs:{companyId:e.companyId,partList:e.ruleForm.baseCompanyItemPartList},on:{selectSuccess:e.partSelect}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"门店价"}},[a("el-input",{attrs:{placeholder:"请输入门店价 单位/元"},model:{value:e.ruleForm.itemOriginalPrice,callback:function(t){e.$set(e.ruleForm,"itemOriginalPrice",t)},expression:"ruleForm.itemOriginalPrice"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"销售价"}},[a("el-input",{attrs:{placeholder:"请输入销售价 单位/元"},model:{value:e.ruleForm.itemPrice,callback:function(t){e.$set(e.ruleForm,"itemPrice",t)},expression:"ruleForm.itemPrice"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"服务时长"}},[a("el-input",{attrs:{placeholder:"请输入项目服务时长"},model:{value:e.ruleForm.itemServiceTime,callback:function(t){e.$set(e.ruleForm,"itemServiceTime",t)},expression:"ruleForm.itemServiceTime"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"建议周期"}},[a("el-input",{attrs:{placeholder:"请输入此项目建议周期"},model:{value:e.ruleForm.suggestCycle,callback:function(t){e.$set(e.ruleForm,"suggestCycle",t)},expression:"ruleForm.suggestCycle"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"适配车型"}},[a("el-switch",{attrs:{"active-text":"自定义车型","inactive-text":"全部车型","active-color":"#409EFF","inactive-color":"#409EFF","active-value":"1","inactive-value":"0"},on:{change:e.selectChange},model:{value:e.ruleForm.carTypeState,callback:function(t){e.$set(e.ruleForm,"carTypeState",t)},expression:"ruleForm.carTypeState"}})],1)],1)],1),e._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:"1"==e.ruleForm.carTypeState,expression:"ruleForm.carTypeState == '1'"}]},[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"已选车型"}},[a("carSelector",{on:{selectSuccess:e.carTypeSelect}}),e._v(" "),e._l(e.ruleForm.basePartCarTypeList,function(t){return a("el-tag",{key:t.carTypeName,staticClass:"tagCar",attrs:{type:"info",size:"small",closable:""},on:{close:function(a){e.handleClose(t.carTypeName)}}},[e._v("\n          "+e._s(t.carTypeName)+"\n          ")])})],2)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.itemDescription,callback:function(t){e.$set(e.ruleForm,"itemDescription",t)},expression:"ruleForm.itemDescription"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.remarks,callback:function(t){e.$set(e.ruleForm,"remarks",t)},expression:"ruleForm.remarks"}})],1)],1)],1),e._v(" "),0!=e.flag?a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("保存")]),e._v(" "),a("el-button",{on:{click:function(t){e.resetForm("ruleForm")}}},[e._v("重置")])],1):e._e()],1)],1)],1)],1)},staticRenderFns:[]};var C=a("VU/8")(y,b,!1,function(e){a("oWxu")},"data-v-0b7c0d6c",null);t.default=C.exports},iXbW:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.tagCar[data-v-0b7c0d6c]{\n  margin-right: 5px;\n}\n",""])},oWxu:function(e,t,a){var r=a("iXbW");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("21b462a2",r,!0)},qAqO:function(e,t,a){"use strict";t.c=function(e){return r.a.fetchPost("/v1/item/selectCompanyItemList",e)},t.b=function(e){return r.a.fetchPost("/v1/item/selectCompanyItemById",e)},t.f=function(e){return r.a.fetchPost("/v1/item/updateCompanyItem",e)},t.e=function(e){return r.a.fetchPost("/v1/item/insertCompanyItem",e)},t.a=function(e){return r.a.fetchPost("/v1/item/deleteCompanyItem",e)},t.d=function(e){return r.a.fetchPost("/v1/item/companyItemCodeUniqueness",e)};var r=a("vLgD")},tAXK:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.card[data-v-222861e5]{\n  margin: 15px 0;\n  width: 100%\n}\n.partTable[data-v-222861e5]{\n  margin: 15px 0;\n  width: 100%\n}\n.del[data-v-222861e5]{\n  color: #606266;\n  font-size: 1.5em;\n  vertical-align: middle;\n  cursor: pointer;\n}\n",""])},yPzP:function(e,t,a){var r=a("tAXK");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("59ba5de8",r,!0)}});